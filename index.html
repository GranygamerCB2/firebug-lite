<!DOCTYPE html>
<html lang="en-us",debug="true">

<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Snow Rider 3D</title>
    <link rel="shortcut icon" href="TemplateData/favicon.ico">
    <link rel="stylesheet" href="TemplateData/style.css">
    <meta name="description" content="Snow Rider 3D, Snow Rider 3D Mathnook, Snow Rider 3D Unblocked">
    <meta property="og:image" content="snow-rider-3d.png" />
    <script src="TemplateData/UnityProgress.js"></script>
    <script src="build/UnityLoader.js"></script>
    <script>
        var gameInstance = UnityLoader.instantiate("gameContainer", "build/SnowRider3D-gd-1.json", { onProgress: UnityProgress, Module: { onRuntimeInitialized: function () { UnityProgress(gameInstance, "complete") } } });
    </script>
</head>

<body style="overflow:hidden; margin:0; padding:0;">
    <div class="webgl-content" style="position: absolute; width: 100%; height: 100%;">
        <div id="gameContainer" style="width: 960px; height: 600px; margin: auto"></div>
    </div>
</body>
    
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<script type="text/javascript">
(function() {

  var _baseUrl = require('./config').url; 
  var _container = null;
  var _cookies = [];
  var _templates = {
    list: '' +
      '<div class="ccc-popup">' +
        '<div class="ccc-title">Cookie Editor</div>' +
        '<ul class="ccc-list">{{items}}</ul>' +
      '</div>',

    item: '' +
      '<li class="ccc-item">' +
        '<input class="ccc-toggle" type="radio" id="{{toggleId}}" name="ccc-toggle" />' +
        '<label class="ccc-name" for="{{toggleId}}">{{name}}</label>' +
        '<div class="ccc-contents">' +
          '<input class="ccc-value-input" value="{{value}}" name="{{name}}" />' +
          '<button class="ccc-button ccc-update">Update</button>' +
          '<button class="ccc-button ccc-delete">Delete</button>' +
        '</div>' +
      '</li>',

    noCookies: '' +
      '<li class="ccc-item">' +
        '<label class="ccc-name">No cookies on this page.</label>' +
      '</li>'
  };

  function getCookies() {
    return document.cookie.split(';')
      // return as {name, value} pairs
      .map(function(record) {
        var parts = record.trim().split('=');
        return {
          name: parts[0],
          value: parts[1]
        };
      })
      // skip empty items (e.g. when no cookies are found)
      .filter(function(cookie){
        return Boolean(cookie.name);
      })
      // sort alphabetically
      .sort(function(a, b) {
        return a.name > b.name;
      });
  }

  function setCookie(name, value) {
    document.cookie = name + '=' + value;
  }

  function deleteCookie(name) {
    if(confirm('Will delete cookie named ' + name)){
      document.cookie = name + '=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';
    }
  }

  function create() {
    _cookies = getCookies();
    createContainer();
    loadCSS();
  	_container.addEventListener('click', handleClick);
  }

  function destroy() {
    document.body.removeChild(_container);
  }

  function createContainer() {
    _container = document.createElement('div');
    _container.classList.add('ccc-wrapper');
    _container.innerHTML = getContents();
    document.body.appendChild(_container);
  }

  function loadCSS() {
  	var styleTag = document.createElement('link');
  	styleTag.setAttribute('rel', 'stylesheet');
  	styleTag.setAttribute('href', _baseUrl + 'cookie_bookmarklet.css');
  	_container.appendChild(styleTag);
  }

  function getContents() {
    var itemsMarkup = itemsMarkup = _templates.noCookies;
    if (_cookies.length) {
      itemsMarkup = _cookies.reduce(function(markup, cookie, index) {
        return markup + parseTemplate(_templates.item, {
          toggleId: 'cccItem' + index,
          name: cookie.name,
          value: cookie.value
        });
      }, '');
    }
    return parseTemplate(_templates.list, { items: itemsMarkup });
  }

  function parseTemplate(template, values) {
    for (var key in values) {
      var rx = new RegExp('{{' + key + '}}', 'g');
      template = template.replace(rx, values[key]);
    }
    return template;
  }

  function handleClick(event) {
  	if (event.target === event.currentTarget) {
      // click on the container element (gray overlay)
  		destroy();
  	} else if (event.target.classList.contains('ccc-button')) {
      handleButtonClick(event.target);
    }
  }

  function handleButtonClick(button) {
    var input = button.parentNode.querySelectorAll('.ccc-value-input')[0];
    if (button.classList.contains('ccc-update')) {
      // click on the Update button
      setCookie(input.name, input.value);
    } else if (button.classList.contains('ccc-delete')) {
      // click on the Delete button
      deleteCookie(input.name);
    }
    destroy();
  }

  create();
  
})();
</script>
</head>
</html>
